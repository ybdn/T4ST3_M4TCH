[
  {"code":"A1","milestone":"M1","title":"[A1] Endpoint de configuration /api/v1/config","labels":["backend","infra","feature-flags","priority:high","size:S"],"body":"### Contexte\nLe frontend a besoin de connaître les feature flags et infos build sans rebuild.\n\n### Objectif\nExposer un endpoint léger JSON: { feature_flags:{...}, build:{hash,timestamp}, version }.\n\n### Tâches\n- [ ] Créer route DRF GET `/api/v1/config/`\n- [ ] Lire flags depuis modèle (ou settings) + defaults\n- [ ] Inclure hash commit (env GIT_SHA) si disponible\n- [ ] Cache headers (ETag ou max-age 60s)\n- [ ] Test API (statut 200 + structure)\n\n### Critères d’acceptation\n- [ ] 200 <50ms p95 (local)\n- [ ] Clés absentes -> defaults\n- [ ] Pas d'info sensible\n\n### Tests\nAPITestCase structure; test absence de flags.\n\n### Risques / Mitigation\nFuite d'env -> whitelist stricte.\n\nDépendances: Aucune"},
  {"code":"A3","milestone":"M1","title":"[A3] Système de Feature Flags backend","labels":["backend","feature-flags","priority:high","size:M"],"body":"### Contexte\nActiver progressivement fonctionnalités.\n\n### Objectif\nModèle FeatureFlag + service cache + intégration config.\n\n### Tâches\n- [ ] Modèle + migration\n- [ ] Admin Django\n- [ ] Service flags.is_enabled(name)\n- [ ] Cache local + invalidation signal\n- [ ] Intégrer endpoint config (A1)\n- [ ] Tests service\n\n### Critères d’acceptation\n- [ ] Flag off coupe code path\n- [ ] Lecture O(1)\n\n### Tests\nToggle + invalidation.\n\n### Risques / Mitigation\nOubli gating -> checklist PR.\n\nDépendances: A1"},
  {"code":"B1","milestone":"M1","title":"[B1] Implémentation RecommendationService (phase 1)","labels":["backend","reco","priority:high","size:M"],"body":"### Contexte\nCode actuel mélange simulation & placeholders.\n\n### Objectif\nRetourner >=10 items hétérogènes filtrant contenu déjà vu.\n\n### Tâches\n- [ ] Stratégies films/séries (TMDB), livres (Google Books), musique (mock)\n- [ ] Factoriser _filter_user_content\n- [ ] TTL cache API externe (APICache)\n- [ ] Log timing par catégorie\n- [ ] Tests unitaires listes non vides\n\n### Critères d’acceptation\n- [ ] Pas de duplication external_id\n- [ ] Scoring compatibilité présent (placeholder ok)\n\n### Tests\nPar source.\n\n### Risques / Mitigation\nAPIs externes lentes -> cache TTL.\n\nDépendances: A3"},
  {"code":"B2","milestone":"M1","title":"[B2] Endpoint action match POST /match/action/","labels":["backend","match","priority:high","size:S"],"body":"### Contexte\nPersister like/dislike/add.\n\n### Objectif\nUpsert UserPreference + stats profil.\n\n### Tâches\n- [ ] Serializer entrée\n- [ ] Upsert UserPreference\n- [ ] Incrément stats\n- [ ] Réponse {success, preference_id, action}\n- [ ] Test idempotence\n\n### Critères d’acceptation\n- [ ] Conflits sans 500\n- [ ] Action hors enum -> 400\n\n### Tests\nIdempotence, validation.\n\n### Risques / Mitigation\nConcurrence -> get_or_create + update.\n\nDépendances: B1"},
  {"code":"B4","milestone":"M1","title":"[B4] Normalisation des sources de contenu","labels":["backend","reco","size:S"],"body":"### Contexte\nStructure hétérogène des items.\n\n### Objectif\nDTO unifié (id, title, source, type, year, thumbnail).\n\n### Tâches\n- [ ] Mapper chaque provider vers DTO\n- [ ] Tests mapping\n\n### Critères\n- [ ] Champs obligatoires toujours présents\n\n### Risques\nChamps manquants -> defaults.\n\nDépendances: B1"},
  {"code":"B5","milestone":"M1","title":"[B5] Remplacer stub useMatchRecommendations","labels":["frontend","match","priority:high","size:M"],"body":"### Contexte\nHook vide.\n\n### Objectif\nConnecter endpoints B1/B2 + pagination simple.\n\n### Tâches\n- [ ] Fetch initial + pagination\n- [ ] submitAction(reco, action)\n- [ ] Gestion erreurs retry\n- [ ] Tests léger mocks\n\n### Critères\n- [ ] Actions retirent item UI\n\n### Risques\nRace conditions -> disable bouton pending.\n\nDépendances: B1,B2"},
  {"code":"F1","milestone":"M1","title":"[F1] Logging structuré backend","labels":["backend","observability","priority:high","size:M"],"body":"### Contexte\nBesoin corrélation.\n\n### Objectif\nLogs JSON + request id + timings.\n\n### Tâches\n- [ ] Config logging JSON\n- [ ] Middleware request id\n- [ ] Log entrée/sortie\n- [ ] Logger reco timings\n- [ ] Tests middleware\n\n### Critères\n- [ ] Pas de token en clair\n\n### Risques\nBruit -> niveaux adaptés.\n\nDépendances: A1"},
  {"code":"G1","milestone":"M1","title":"[G1] Rate limiting global & sensibles","labels":["backend","security","priority:high","size:S"],"body":"### Contexte\nLimiter abus.\n\n### Objectif\nThrottling DRF auth/match/friends add.\n\n### Tâches\n- [ ] Config rates\n- [ ] Classe custom clé user/ip\n- [ ] Tests dépassement 429\n- [ ] Doc README\n\n### Critères\n- [ ] Action match 60/min\n\n### Risques\nBlocage faux positifs -> marges.\n\nDépendances: A1"},
  {"code":"C1","milestone":"M2","title":"[C1] Endpoint profil social GET /social/profile/me","labels":["backend","social","priority:high","size:S"],"body":"### Contexte\nAfficher profil.\n\n### Objectif\nRetourner profil + stats.\n\n### Tâches\n- [ ] Serializer profil\n- [ ] Stats agrégées\n- [ ] Vue DRF auth\n- [ ] Création auto si absent\n\n### Critères\n- [ ] <80ms local\n\n### Risques\nRequêtes multiples -> select_related.\n\nDépendances: A1,A3"},
  {"code":"C3","milestone":"M2","title":"[C3] Hook useSocialProfile réel","labels":["frontend","social","priority:high","size:S"],"body":"### Contexte\nHook stub.\n\n### Objectif\nFetch profil + cache local.\n\n### Tâches\n- [ ] Impl fetch + états\n- [ ] Reload manuel\n- [ ] Gestion 401\n\n### Critères\n- [ ] Profil affiché stable\n\n### Risques\nBoucles fetch -> garde flag.\n\nDépendances: C1"},
  {"code":"D1","milestone":"M2","title":"[D1] Endpoint ajout ami POST /social/friends/add","labels":["backend","social","priority:high","size:M"],"body":"### Contexte\nAjout ami absent.\n\n### Objectif\nCréer Friendship pending.\n\n### Tâches\n- [ ] Validation gamertag\n- [ ] Empêcher doublon ordre inversé\n- [ ] Rate limit throttle\n- [ ] Réponse {success,id,status}\n\n### Critères\n- [ ] Pas self-add\n\n### Risques\nCourse doublons -> contrainte unique.\n\nDépendances: C1"},
  {"code":"D2","milestone":"M2","title":"[D2] Endpoint liste amis GET /social/friends/","labels":["backend","social","priority:high","size:S"],"body":"### Contexte\nLister amis.\n\n### Objectif\nRetourner accepted.\n\n### Tâches\n- [ ] Query accepted\n- [ ] Map friend user\n- [ ] Test 0 amis\n\n### Critères\n- [ ] <50ms local\n\n### Risques\nN+1 -> select_related.\n\nDépendances: D1"},
  {"code":"D4","milestone":"M2","title":"[D4] UI liste & ajout amis","labels":["frontend","social","priority:high","size:M"],"body":"### Contexte\nComposant stub.\n\n### Objectif\nBrancher D1/D2.\n\n### Tâches\n- [ ] Hook useFriends\n- [ ] Hook useFriendSearch\n- [ ] Pending count placeholder\n- [ ] Toasts\n\n### Critères\n- [ ] Ami ajouté apparaît\n\n### Risques\nDouble submit -> disabled state.\n\nDépendances: D2"},
  {"code":"D3","milestone":"M2","title":"[D3] Endpoint acceptation ami POST /social/friends/accept","labels":["backend","social","size:S"],"body":"### Contexte\nAcceptation manquante.\n\n### Objectif\nTransition pending->accepted.\n\n### Tâches\n- [ ] Endpoint accept\n- [ ] Validation requester/addressee\n- [ ] Test succès / erreurs\n\n### Critères\n- [ ] Idempotent\n\n### Risques\nConflits -> select for update.\n\nDépendances: D1"},
  {"code":"B3","milestone":"M2","title":"[B3] Filtrage préférence utilisateur avancé","labels":["backend","reco","size:M"],"body":"### Contexte\nFiltrage simple insuffisant.\n\n### Objectif\nExclure contenus déjà notés + scoring léger.\n\n### Tâches\n- [ ] Index sur UserPreference\n- [ ] Query exclusion performante\n- [ ] Ajuster scoring\n\n### Critères\n- [ ] Pas de contenu répété en 50 tirages\n\n### Risques\nRequêtes lourdes -> limiter colonnes.\n\nDépendances: B1"},
  {"code":"E2","milestone":"M3","title":"[E2] Création match Versus POST /versus/matches","labels":["backend","versus","priority:high","size:M"],"body":"### Contexte\nService non exposé.\n\n### Objectif\nCréer FriendMatch + rounds init.\n\n### Tâches\n- [ ] Serializer target + rounds\n- [ ] Validation amis\n- [ ] Génération contenu (reco)\n- [ ] Réponse {match_id,total_rounds}\n\n### Critères\n- [ ] Unique si aucun match actif identique\n\n### Risques\nAPI lentes -> async futur.\n\nDépendances: D2,B1"},
  {"code":"E4","milestone":"M3","title":"[E4] Soumettre choix Versus POST /versus/matches/{id}/choice","labels":["backend","versus","priority:high","size:M"],"body":"### Contexte\nProgression match.\n\n### Objectif\nEnregistrer choix round courant.\n\n### Tâches\n- [ ] Validation tour/utilisateur\n- [ ] Détection match liked/liked\n- [ ] MAJ score + round suivant\n- [ ] Réponse état match\n\n### Critères\n- [ ] Double soumission -> 400\n\n### Risques\nConditions concurrence -> transactions.\n\nDépendances: E2"},
  {"code":"E5","milestone":"M3","title":"[E5] Endpoint état session Versus GET /versus/matches/{id}","labels":["backend","versus","size:S"],"body":"### Contexte\nUI a besoin de l'état.\n\n### Objectif\nRetourner round courant + scores.\n\n### Tâches\n- [ ] Serializer état\n- [ ] Permissions participants\n- [ ] Test progression\n\n### Critères\n- [ ] Champ terminé bool\n\n### Risques\nFuite données tiers -> filtre.\n\nDépendances: E2"},
  {"code":"E6","milestone":"M3","title":"[E6] Interface VersusMatch (remplacer stub)","labels":["frontend","versus","priority:high","size:L"],"body":"### Contexte\nPlaceholder.\n\n### Objectif\nAfficher progression et actions.\n\n### Tâches\n- [ ] Hook useVersusSession\n- [ ] submitChoice (E4)\n- [ ] Animation match\n- [ ] Résumé fin\n\n### Critères\n- [ ] Pas d'action si session finie\n\n### Risques\nEtat désync -> refetch round.\n\nDépendances: E4"},
  {"code":"E7","milestone":"M3","title":"[E7] Hook frontend useVersusMatchList","labels":["frontend","versus","size:M"],"body":"### Contexte\nLister matches existants.\n\n### Objectif\nAfficher matches actifs + terminés.\n\n### Tâches\n- [ ] Endpoint liste (si absent)\n- [ ] Hook data + refresh\n\n### Critères\n- [ ] Tri par updated desc\n\n### Risques\nPagination manquante -> limiter 20.\n\nDépendances: E2"},
  {"code":"H1","milestone":"M3","title":"[H1] Cache API externe reco (optimisation)","labels":["backend","performance","size:S"],"body":"### Contexte\nLatence externe.\n\n### Objectif\nIntroduire cache TTL côté services.\n\n### Tâches\n- [ ] Wrapper get_external\n- [ ] TTL configurable env\n- [ ] Metrics hits/miss\n\n### Critères\n- [ ] Hit rate >40% après warm (local test)\n\n### Risques\nDonnées périmées -> TTL court.\n\nDépendances: B1"},
  {"code":"H2","milestone":"M3","title":"[H2] Index DB préférences","labels":["backend","performance","size:S"],"body":"### Contexte\nRequêtes exclusion potentiellement lentes.\n\n### Objectif\nAjouter index composite (user_id, external_id).\n\n### Tâches\n- [ ] Migration index\n- [ ] Mesure avant/après (explain)\n\n### Critères\n- [ ] Plan utilise index\n\n### Risques\nVerrou migration -> faible trafic.\n\nDépendances: B1"},
  {"code":"F2","milestone":"M4","title":"[F2] Intégration Sentry backend","labels":["backend","observability","size:S"],"body":"### Contexte\nErreurs silencieuses.\n\n### Objectif\nCapturer exceptions.\n\n### Tâches\n- [ ] Ajouter sdk sentry\n- [ ] DSN via env\n- [ ] Filtrer données sensibles\n\n### Critères\n- [ ] 1 erreur test visible\n\n### Risques\nLeak PII -> scrubbing.\n\nDépendances: F1"},
  {"code":"F3","milestone":"M4","title":"[F3] Metrics basiques (Prometheus endpoint)","labels":["backend","observability","size:M"],"body":"### Contexte\nPas de métriques.\n\n### Objectif\nExpose /metrics (django-prom).\n\n### Tâches\n- [ ] Installer lib\n- [ ] Compteurs requêtes, latence reco\n- [ ] Docs dashboard exemple\n\n### Critères\n- [ ] Latence reco visible\n\n### Risques\nOverhead -> échantillonnage.\n\nDépendances: F1"},
  {"code":"F4","milestone":"M4","title":"[F4] Tests unitaires services reco (>=70% lignes)","labels":["backend","tests","size:M"],"body":"### Contexte\nFaible couverture.\n\n### Objectif\n>=70% lignes RecommendationService.\n\n### Tâches\n- [ ] Cas succès multi-sources\n- [ ] Cas sources vides\n- [ ] Cas cache hit/miss (mock)\n\n### Critères\n- [ ] Rapport coverage valide\n\n### Risques\nTests fragiles -> isoler IO.\n\nDépendances: B1"},
  {"code":"F5","milestone":"M4","title":"[F5] Tests API critiques (match, social, versus)","labels":["backend","tests","size:M"],"body":"### Contexte\nEndpoints sans tests.\n\n### Objectif\nAPITestCases cœur métier.\n\n### Tâches\n- [ ] Match action\n- [ ] Profil social\n- [ ] Versus création/choix\n\n### Critères\n- [ ] Tous 200/4xx attendus\n\n### Risques\nLenteur -> réutiliser fixtures.\n\nDépendances: B2,C1,E4"},
  {"code":"F6","milestone":"M4","title":"[F6] Tests frontend hooks clés","labels":["frontend","tests","size:M"],"body":"### Contexte\nHooks non testés.\n\n### Objectif\nTests pour useMatchRecommendations, useSocialProfile, useVersusSession.\n\n### Tâches\n- [ ] Setup test utils\n- [ ] Mocks fetch\n- [ ] Cas succès/erreur/loading\n\n### Critères\n- [ ] Branches principales couvertes\n\n### Risques\nFlakiness -> timers fake.\n\nDépendances: B5,C3,E6"},
  {"code":"G2","milestone":"M4","title":"[G2] Validation stricte entrées API","labels":["backend","security","size:M"],"body":"### Contexte\nRisques inputs malformés.\n\n### Objectif\nSerializers renforcés + tests 400.\n\n### Tâches\n- [ ] Champs obligatoires\n- [ ] Enums contrôlés\n- [ ] Tests invalides\n\n### Critères\n- [ ] 0 warning DRF validators\n\n### Risques\nRejets faux positifs -> logs debug.\n\nDépendances: B2,D1,E2"},
  {"code":"G3","milestone":"M4","title":"[G3] Headers sécurité & CSP","labels":["backend","security","size:S"],"body":"### Contexte\nHeaders défaut.\n\n### Objectif\nAjouter CSP stricte + HSTS dev opt.\n\n### Tâches\n- [ ] Middleware headers\n- [ ] Tests présence\n\n### Critères\n- [ ] Pas de blocage assets\n\n### Risques\nCSP trop stricte -> assouplir directives.\n\nDépendances: A1"},
  {"code":"I1","milestone":"M4","title":"[I1] Manifest & métadonnées PWA complètes","labels":["frontend","pwa","size:S"],"body":"### Contexte\nManifest partiel.\n\n### Objectif\nIcônes, couleurs, scope, orientation.\n\n### Tâches\n- [ ] Compléter manifest.json\n- [ ] Meta theme-color\n- [ ] Test Lighthouse PWA installable\n\n### Critères\n- [ ] Score PWA >= 80 (indicatif)\n\n### Risques\nIcônes manquantes -> fallback.\n\nDépendances: A1"},
  {"code":"I3","milestone":"M4","title":"[I3] Accessibilité de base (a11y pass)","labels":["frontend","a11y","size:M"],"body":"### Contexte\nA11y non évaluée.\n\n### Objectif\nLabels ARIA, contrastes, navigation clavier.\n\n### Tâches\n- [ ] Audit rapide axe\n- [ ] Fix focus & roles\n- [ ] Vérif contrastes\n\n### Critères\n- [ ] Score aXe sans erreurs critiques\n\n### Risques\nRégressions UI -> revue visuelle.\n\nDépendances: B5,D4,E6"},
  {"code":"J2","milestone":"M4","title":"[J2] Guide CONTRIBUTING.md","labels":["docs","devex","size:S"],"body":"### Contexte\nPas de guide.\n\n### Objectif\nDécrire setup, conventions commits, tests.\n\n### Tâches\n- [ ] Rédiger CONTRIBUTING.md\n- [ ] Lier dans README\n\n### Critères\n- [ ] Nouveau dev <15min setup\n\n### Risques\nDoc obsolète -> revue périodique.\n\nDépendances: A1"},
  {"code":"J4","milestone":"M4","title":"[J4] Script seed cohérent (démo)","labels":["backend","devex","size:S"],"body":"### Contexte\nSeed social partiel.\n\n### Objectif\nDonnées démo cohérentes (profils + prefs + match).\n\n### Tâches\n- [ ] Étendre seed_social.py\n- [ ] Doc usage\n\n### Critères\n- [ ] Run unique idempotent\n\n### Risques\nConflits migrations -> ordre.\n\nDépendances: B2,C1"},
  {"code":"K2","milestone":"M5","title":"[K2] Checklist pré-bêta (stabilité)","labels":["launch","size:M"],"body":"### Contexte\nAvant ouverture bêta.\n\n### Objectif\nChecklist: logs, tests, flags corrects.\n\n### Tâches\n- [ ] Document checklist\n- [ ] Vérifier endpoints clés\n\n### Critères\n- [ ] Tous items cochés\n\n### Risques\nOubli -> double revue.\n\nDépendances: F5,F6"},
  {"code":"K1","milestone":"M5","title":"[K1] Stratégie invitation bêta","labels":["launch","size:S"],"body":"### Contexte\nAccès contrôlé.\n\n### Objectif\nDéfinir process invitations (liste emails / flag).\n\n### Tâches\n- [ ] Modèle BetaInvite\n- [ ] Endpoint validation token\n- [ ] Doc process\n\n### Critères\n- [ ] Invité peut se connecter\n\n### Risques\nAbus tokens -> TTL.\n\nDépendances: A3"},
  {"code":"K3","milestone":"M5","title":"[K3] Instrumentation métriques usage bêta","labels":["launch","observability","size:M"],"body":"### Contexte\nSuivi usage nécessaire.\n\n### Objectif\nCompteurs daily active, actions, matches.\n\n### Tâches\n- [ ] Events instrumentation\n- [ ] Dashboard simple\n\n### Critères\n- [ ] Vision quotidienne active users\n\n### Risques\nSurcharge logs -> sampling.\n\nDépendances: F3"},
  {"code":"H3","milestone":"M5","title":"[H3] Optim requêtes n+1 social","labels":["backend","performance","size:M"],"body":"### Contexte\nRisque n+1 social.\n\n### Objectif\nPrefetch/select_related profils/statistiques.\n\n### Tâches\n- [ ] Audit query debug toolbar\n- [ ] Optimisations ciblées\n\n### Critères\n- [ ] <5 requêtes page sociale\n\n### Risques\nSur-optimisation -> mesurer.\n\nDépendances: C1,D2"},
  {"code":"I2","milestone":"M5","title":"[I2] Offline shell minimal","labels":["frontend","pwa","size:M"],"body":"### Contexte\nPWA offline incomplet.\n\n### Objectif\nCache shell (home + assets critiques).\n\n### Tâches\n- [ ] SW cache install\n- [ ] Stratégie stale-while-revalidate\n- [ ] Test mode avion\n\n### Critères\n- [ ] Page home charge offline\n\n### Risques\nCache obsolète -> versioning.\n\nDépendances: I1"},
  {"code":"G4","milestone":"M5","title":"[G4] Audit sécurité léger (OWASP top 10)","labels":["backend","security","size:M"],"body":"### Contexte\nAvant bêta large.\n\n### Objectif\nPasser checklist OWASP basique.\n\n### Tâches\n- [ ] CSRF, XSS, injections\n- [ ] Mots de passe robustesse\n- [ ] Rapport actions\n\n### Critères\n- [ ] Aucun item critique ouvert\n\n### Risques\nTemps -> focus critiques.\n\nDépendances: G2,G3"},
  {"code":"K4","milestone":"M5","title":"[K4] Page changelog & versioning","labels":["docs","launch","size:S"],"body":"### Contexte\nManque transparence versions.\n\n### Objectif\nPage changelog + version semver affichée.\n\n### Tâches\n- [ ] Fichier CHANGELOG.md\n- [ ] Injection version frontend\n\n### Critères\n- [ ] Version visible /config\n\n### Risques\nOubli maj -> script release.\n\nDépendances: A1"},
  {"code":"PostBeta","milestone":"M6","title":"[M6] Optim & polish post-bêta (lot initial)","labels":["post-beta","size:L"],"body":"### Contexte\nAprès bêta fermée.\n\n### Objectif\nRegrouper améliorations perf/UX mineures.\n\n### Pistes\n- [ ] Optim images\n- [ ] Améliorer scoring reco\n- [ ] Réduction bundle\n\n### Critères\n- [ ] Pas de régression\n\n### Risques\nScope creep -> limiter par sprint.\n\nDépendances: K2"}
]
